{% import "_macros.html" as macros %}

{% set logo = load_data(path="static/logo.svg") %}
{% set logo_font_light = load_data(path="static/logo_font_light.svg") %}
{% set logo_font_dark = load_data(path="static/logo_font_dark.svg") %}

<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="stylesheet" href="/css/main.css" />
    <link rel="canonical" href="{{ current_url | safe }}" />
    <link rel="me" href="https://mastodon.social/@mre" />
    <link
      href="https://fonts.googleapis.com/css2?family=Bitter:ital,wght@0,100..900;1,100..900&display=swap"
      rel="stylesheet"
    />

    <style>

      @font-face {
        font-family: "Happy-Headline";
        src: url("/fonts/Happy-Headline.ttf") format("truetype");
        font-weight: normal;
        font-style: normal;
      }

      @font-face {
        font-family: "Happy";
        src: url("/fonts/Happy.ttf") format("truetype");
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="icon" href="data:image/svg+xml;utf8,{{ logo }}" />

    <link href="/rss.xml" rel="alternate" type="application/rss+xml" />
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="theme-color" content="#ffffff" />
    <meta name="author" content="Matthias Endler" />
    <meta
      name="description"
      content="Personal website of Matthias Endler, a Software Engineer interested in low-level programming and Backend development. Rust, Go"
    />

    {%- block header %}
    <title>Matthias Endler</title>
    {%- endblock header %}
  </head>

  <body>
    <div class="container">
      <header class="logo-header">
        <a href="/" aria-label="Go back to homepage">
          <div class="logo">{{ logo | safe }}</div>
        </a>
        <h1>Matthias Endler</h1>
      </header>

        <main>
          {% block content %}
          {% for page in paginator.pages %}
            {% include "snippets/article_preview.html" %}
          {% endfor %}

        <div style="display: flex; justify-content: space-between">
          {% if paginator.previous %}
            <a class="btn" href="{{  paginator.previous}}">« Next</a>
          {% endif %}
          {% if paginator.next %}
            <a class="btn" href="{{  paginator.next }}">Previous »</a>
          {% endif %}
        </div>
        {% endblock content %}
      </main>
    </div>
    {% include "snippets/footer.html" %}
    <script>
      // Check for saved theme preference or use the browser's preference
      function initTheme() {
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme) {
          document.documentElement.setAttribute('data-theme', savedTheme);
        } else {
          // Use browser preference as default
          if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.setAttribute('data-theme', 'dark');
          } else {
            document.documentElement.setAttribute('data-theme', 'light');
          }
        }
      }

      // Toggle between light and dark themes
      function toggleTheme() {
        const currentTheme = document.documentElement.getAttribute('data-theme') || 'light';
        const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
        
        document.documentElement.setAttribute('data-theme', newTheme);
        localStorage.setItem('theme', newTheme);
      }

      // Initialize theme when page loads
      initTheme();
      
      // Listen for system preference changes
      if (window.matchMedia) {
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
          if (!localStorage.getItem('theme')) {
            document.documentElement.setAttribute('data-theme', event.matches ? 'dark' : 'light');
          }
        });
      }
    </script>
  </body>
</html>
